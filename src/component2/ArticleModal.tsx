// components/ArticleModal.tsx
import React, { useEffect } from 'react';
import '../style2/ArticleModal.css';

interface Article {
  id: number;
  title: string;
  summary: string;
  image: string;
  desktop_image: string;
  mobile_image: string;
  author: string;
  read_time: string;
  category: string;
  full_content?: string;
  created_at: string;
}

interface ArticleModalProps {
  article: Article | null;
  isOpen: boolean;
  onClose: () => void;
}

const ArticleModal: React.FC<ArticleModalProps> = ({ isOpen, onClose, article }) => {
  useEffect(() => {
    const handleEsc = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        onClose();
      }
    };

    if (isOpen) {
      document.addEventListener('keydown', handleEsc);
      document.body.style.overflow = 'hidden'; // ุฌููฺฏุฑ ุงุฒ ุงุณฺฉุฑูู ูพุดุช ุตูุญู
    }

    return () => {
      document.removeEventListener('keydown', handleEsc);
      document.body.style.overflow = 'unset';
    };
  }, [isOpen, onClose]);

  if (!isOpen || !article) return null;

  // ูุญุชูุง ฺฉุงูู ููุงูู (ุจุฑุง ููุงุด ุฏุฑ ูพุงูพโุขูพ)
  const getFullContent = () => {
    if (article.full_content) return article.full_content;

    // ูุญุชูุง ูพุดโูุฑุถ ุจุฑ ุงุณุงุณ ุฏุณุชูโุจูุฏ
    const contents: { [key: string]: string } = {
      'ุฑุงูููุง ุฎุฑุฏ': `
        <h4>ูฺฉุงุช ููู ุฏุฑ ุฎุฑุฏ ูุจููุงู</h4>
        <p>ฑ. ุงูุฏุงุฒู ูุถุง ุฑุง ุฏูู ุงูุฏุงุฒูโฺฏุฑ ฺฉูุฏ: ูุจู ุงุฒ ุฎุฑุฏุ ุญุชูุงู ุงุจุนุงุฏ ูุญู ูุฑุงุฑฺฏุฑ ูุจููุงู ุฑุง ุงูุฏุงุฒู ุจฺฏุฑุฏ. ุญุฏุงูู ทฐ ุณุงูุชูุชุฑ ูุถุง ุฑูุช ู ุขูุฏ ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ.</p>
        <p>ฒ. ุฌูุณ ูพุงุฑฺู ุฑุง ุจุฑุฑุณ ฺฉูุฏ: ูพุงุฑฺูโูุง ูุฎูู ุจุฑุง ูุฌุงูุณ ุฑุณูุ ฺฉุชุงู ุจุฑุง ุงุณุชูุงุฏู ุฑูุฒูุฑู ู ูฺฉุฑููุงุจุฑ ุจุฑุง ุฎุงููุงุฏูโูุง ุฏุงุฑุง ฺฉูุฏฺฉ ููุงุณุจโุชุฑ ุงุณุช.</p>
        <p>ณ. ุงุณฺฉูุช ูุจููุงู: ุงุณฺฉูุช ฺูุจ ุจุง ฺฉูุช (ุฑุงุด ุง ฺฏุฑุฏู) ููุงููุช ุจุงูุง ุฏุงุฑุฏ. ุงุฒ ูุฑูุดูุฏู ฺฏุงุฑุงูุช ุงุณฺฉูุช ุจุฎูุงูุฏ.</p>
        <p>ด. ููู ู ููุฑ: ููู ุจุง ฺฺฏุงู ุจุงูุง ู ููุฑูุง ูุงุฑูพฺ ฺฉูุช ุจูุชุฑ ุฏุงุฑูุฏ ู ุจุงุนุซ ุฏูุงู ุจุดุชุฑ ูุจููุงู ูโุดููุฏ.</p>
        <p>ต. ุฎุฏูุงุช ูพุณ ุงุฒ ูุฑูุด: ุญุชูุงู ุงุฒ ฺฏุงุฑุงูุช ู ุฎุฏูุงุช ูพุณ ุงุฒ ูุฑูุด ูุทูุฆู ุดูุฏ.</p>
      `,
      'ุฏฺฉูุฑุงุณูู': `
        <h4>ุชุฑูุฏูุง ุฏฺฉูุฑุงุณูู ฒฐฒต</h4>
        <p>ฑ. ุฑูฺฏโูุง ุทุจุน: ุณุจุฒ ุฒุชููุ ููููโุง ฺฏุฑู ู ุจฺ ุฏุฑ ุตุฏุฑ ุชุฑูุฏูุง ุงูุณุงู ูุฑุงุฑ ุฏุงุฑูุฏ.</p>
        <p>ฒ. ูุจููุงู ูุงฺููุงุฑ: ูุจููุงูโูุง ฺฉู ูโุชูุงูุฏ ุขููุง ุฑุง ุฌุงุจุฌุง ู ุชุบุฑ ุดฺฉู ุฏูุฏุ ุจุณุงุฑ ูุญุจูุจ ุดุฏูโุงูุฏ.</p>
        <p>ณ. ููุงุฏ ุทุจุน: ุงุณุชูุงุฏู ุงุฒ ฺูุจุ ุณูฺฏุ ุญุตุฑ ู ูพุงุฑฺูโูุง ุทุจุน ุฏุฑ ุฏฺฉูุฑุงุณูู ุงูุฒุงุด ุงูุชู ุงุณุช.</p>
        <p>ด. ูููุงูุณู ฺฏุฑู: ุชุฑฺฉุจ ุณุงุฏฺฏ ูููุงู ุจุง ุฑูฺฏโูุง ู ุจุงูุชโูุง ฺฏุฑู ู ุฏููุดู.</p>
        <p>ต. ฺฏูุดูโูุง ุฏูุฌ: ุงุฌุงุฏ ูุถุงูุง ฺฉูฺฺฉ ู ุฏูุฌ ุจุฑุง ูุทุงูุนู ุง ุงุณุชุฑุงุญุช ุฏุฑ ุฎุงูู.</p>
      `,
      'ุงฺฉุณุณูุฑ': `
        <h4>ูฺฉุงุช ุงูุชุฎุงุจ ุงฺฉุณุณูุฑ</h4>
        <p>ฑ. ุชุนุงุฏู ุฑุง ุฑุนุงุช ฺฉูุฏ: ูู ุฎู ุดููุบุ ูู ุฎู ุฎููุช. ุงุฒ ูุงููู ถฐ-ณฐ-ฑฐ ุงุณุชูุงุฏู ฺฉูุฏ.</p>
        <p>ฒ. ุงูุฏุงุฒู ูุชูุงุณุจ: ุงฺฉุณุณูุฑ ุจุงุฏ ุจุง ุงูุฏุงุฒู ูุถุง ู ูุจููุงู ุชูุงุณุจ ุฏุงุดุชู ุจุงุดุฏ.</p>
        <p>ณ. ุฑูฺฏโูุง ูฺฉูู: ุงุฒ ฺุฑุฎู ุฑูฺฏ ุจุฑุง ุงูุชุฎุงุจ ุฑูฺฏโูุง ูฺฉูู ุงุณุชูุงุฏู ฺฉูุฏ.</p>
        <p>ด. ุจุงูุชโูุง ูุฎุชูู: ุชุฑฺฉุจ ุจุงูุชโูุง ูุฎุชูู ูุซู ุดุดูุ ฺูุจุ ููุฒ ู ูพุงุฑฺู ุฌุฐุงุจุช ูุถุง ุฑุง ุงูุฒุงุด ูโุฏูุฏ.</p>
        <p>ต. ููุฑูพุฑุฏุงุฒ: ุงุฒ ุขุจุงฺูุฑ ู ฺุฑุงุบโูุง ุฏฺฉูุฑุงุชู ุจุฑุง ุงุฌุงุฏ ุนูู ู ฺฏุฑูุง ุงุณุชูุงุฏู ฺฉูุฏ.</p>
      `,
      'ูุญุท ุฒุณุช': `
        <h4>ูุจููุงู ุฏูุณุชุฏุงุฑ ูุญุท ุฒุณุช</h4>
        <p>ฑ. ฺูุจโูุง ุจุงุฒุงูุช: ุงุณุชูุงุฏู ุงุฒ ฺูุจโูุง ุจุงุฒุงูุช ุจู ฺฉุงูุด ูุทุน ุฏุฑุฎุชุงู ฺฉูฺฉ ูโฺฉูุฏ.</p>
        <p>ฒ. ุฑูฺฏโูุง ุจุฏูู VOC: ุฑูฺฏโูุง ุจุฏูู ุชุฑฺฉุจุงุช ุขู ูุฑุงุฑ ุจุฑุง ุณูุงูุช ู ูุญุท ุฒุณุช ุจูุชุฑ ูุณุชูุฏ.</p>
        <p>ณ. ูพุงุฑฺูโูุง ุทุจุน: ูพูุจู ุงุฑฺฏุงูฺฉุ ฺฉุชุงู ู ฺฉูู ฺฏุฒููโูุง ูพุงุฏุงุฑุชุฑ ูุณุชูุฏ.</p>
        <p>ด. ูุจููุงู ูุงฺููุงุฑ: ูุงุจูุช ุชุนูุฑ ู ุฌุงฺฏุฒู ูุทุนุงุช ุจุงุนุซ ุงูุฒุงุด ุนูุฑ ูุจููุงู ูโุดูุฏ.</p>
        <p>ต. ุจุณุชูโุจูุฏ ูุงุจู ุจุงุฒุงูุช: ุงุฒ ุจุฑูุฏูุง ฺฉู ุจุณุชูโุจูุฏ ูุงุจู ุจุงุฒุงูุช ุงุณุชูุงุฏู ูโฺฉููุฏุ ุญูุงุช ฺฉูุฏ.</p>
      `,
      'ุฑูฺฏ': `
        <h4>ุฑูฺฏโูุง ูุญุจูุจ ฑดฐด</h4>
        <p>ฑ. ููููโุง ฺฏุฑู: ุฑูฺฏ ุขุฑุงูุดโุจุฎุด ู ุตูู ฺฉู ุจุง ุจุณุงุฑ ุงุฒ ุณุจฺฉโูุง ููุงููฺฏ ุงุณุช.</p>
        <p>ฒ. ุณุจุฒ ูุฑูโฺฏู: ุชุฑฺฉุจ ุงุฒ ุณุจุฒ ู ุฎุงฺฉุณุชุฑุ ุฑูฺฏ ูุฏุฑู ู ุขุฑุงูุดโุจุฎุด.</p>
        <p>ณ. ุขุจ ููุงู: ุฑูฺฏ ุฎูุซ ู ุขุฑุงู ฺฉู ุจุง ฺูุจ ู ุณูุฏ ุนุงู ูโุดูุฏ.</p>
        <p>ด. ูุงุฑูุฌ ุณูุฎุชู: ุฑูฺฏ ูพุฑุงูุฑฺ ู ฺฏุฑู ุจุฑุง ูุถุงูุง ุฎุงุต.</p>
        <p>ต. ุจููุด ููุงู: ุฑูฺฏ ููฺฉุณ ู ุฎุงุต ุจุฑุง ูุถุงูุง ูุฏุฑู.</p>
      `,
      'ฺุฏูุงู': `
        <h4>ุงุตูู ฺุฏูุงู ูุฏุฑู</h4>
        <p>ฑ. ููุทู ฺฉุงููู: ฺฉ ููุทู ฺฉุงููู ุฏุฑ ูุถุง ุงูุชุฎุงุจ ฺฉูุฏ (ุดููููุ ุชููุฒูู ุง ฺฉ ุชุงุจูู).</p>
        <p>ฒ. ฺฏุฑุฏุด ูุถุง: ูุณุฑูุง ุฑูุช ู ุขูุฏ ุฑุง ุจุงุฒ ูฺฏู ุฏุงุฑุฏุ ุญุฏุงูู ทฐ ุณุงูุชูุชุฑ ูุงุตูู.</p>
        <p>ณ. ุชุนุงุฏู ุจุตุฑ: ูุจููุงู ุณูฺฏู ุฑุง ุฏุฑ ููุงุจู ูู ูุฑุงุฑ ุฏูุฏ ุชุง ุชุนุงุฏู ุจุฑูุฑุงุฑ ุดูุฏ.</p>
        <p>ด. ูุงูโุจูุฏ: ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฑุดุ ฺฉูุณูุ ูพุชู ู ููุฑูพุฑุฏุงุฒ ุนูู ุงุฌุงุฏ ฺฉูุฏ.</p>
        <p>ต. ุงุฑุชูุงุน: ุงุฒ ููุณูุ ุขุจุงฺูุฑูุง ุจููุฏ ู ุชุงุจูููุง ุนููุฏ ุจุฑุง ุงุฌุงุฏ ุชููุน ุงุฑุชูุงุน ุงุณุชูุงุฏู ฺฉูุฏ.</p>
      `,
      'ูฺฏูุฏุงุฑ': `
        <h4>ูุฑุงูุจุช ุงุฒ ูุจููุงู ฺุฑู</h4>
        <p>ฑ. ุชูุฒ ฺฉุฑุฏู ููุธู: ูุฑ ููุชู ุจุง ุฏุณุชูุงู ูุฑู ู ุฎุดฺฉ ฺฏุฑุฏฺฏุฑ ฺฉูุฏ.</p>
        <p>ฒ. ููุงุฏ ุดููุฏู: ุงุฒ ุดููุฏูโูุง ูุฎุตูุต ฺุฑู ุงุณุชูุงุฏู ฺฉูุฏุ ูุฑฺฏุฒ ุงุฒ ุงูฺฉู ุง ูุงุชฺฉุณ ุงุณุชูุงุฏู ูฺฉูุฏ.</p>
        <p>ณ. ููุฑ ุฎูุฑุดุฏ: ูุจููุงู ฺุฑู ุฑุง ุฏุฑ ูุนุฑุถ ุชุงุจุด ูุณุชูู ููุฑ ุฎูุฑุดุฏ ูุฑุงุฑ ูุฏูุฏ.</p>
        <p>ด. ุฑุทูุจุช: ุฑุทูุจุช ุฏุดูู ฺุฑู ุงุณุชุ ุจูุงูุงุตูู ูุงุนุงุช ุฑุฎุชู ุดุฏู ุฑุง ูพุงฺฉ ฺฉูุฏ.</p>
        <p>ต. ูุฑูโฺฉููุฏู: ูุฑ ถ ูุงู ฺฉุจุงุฑ ุงุฒ ูุฑูโฺฉููุฏู ฺุฑู ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ุงูุนุทุงู ุฎูุฏ ุฑุง ุญูุธ ฺฉูุฏ.</p>
      `,
      'ฺฉูุงุณฺฉ': `
        <h4>ูุจููุงู ฺฉูุงุณฺฉ</h4>
        <p>ฑ. ูฺฺฏโูุง: ููุจุชโฺฉุงุฑุ ูพุงุฑฺูโูุง ูุฌููุ ุฎุทูุท ููุญู ู ุฌุฒุฆุงุช ุธุฑู.</p>
        <p>ฒ. ุฑูฺฏโุจูุฏ: ุฑูฺฏโูุง ฺฏุฑู ู ุณูฺฏู ูุซู ุดุฑุงุจุ ุฒุฑุดฺฉุ ุทูุง ู ุณุจุฒ ุฒูุฑุฏ.</p>
        <p>ณ. ูพุงุฑฺู: ูุฎููุ ุงุจุฑุดู ู ูพุงุฑฺูโูุง ุจุฑุฌุณุชูโุฏุงุฑ ุจุง ุทุฑุญโูุง ฺฉูุงุณฺฉ.</p>
        <p>ด. ฺุฏูุงู: ูุนูููุงู ูุชูุงุฑู ู ุฑุณูุ ุจุง ูุทุนุงุช ุจุฒุฑฺฏ ู ุจุง ุดฺฉูู.</p>
        <p>ต. ุชุฑฺฉุจ ุจุง ูุฏุฑู: ูโุชูุงูุฏ ฺูุฏ ูุทุนู ฺฉูุงุณฺฉ ุฑุง ุจุง ุงููุงูโูุง ูุฏุฑู ุชุฑฺฉุจ ฺฉูุฏ ุชุง ูุถุง ุฎุงุต ุจุณุงุฒุฏ.</p>
      `
    };

    return contents[article.category] || contents['ุฑุงูููุง ุฎุฑุฏ'];
  };

  return (
    <div className="modal-overlay modal-wrapper" onClick={onClose}>

      {/* wrapper ูููโูุงุฏ */}
      <div className="modal-wrapper" onClick={(e) => e.stopPropagation()}>

        <button className="modal-close" onClick={onClose}>ร</button>

        <article className="modal-article">

          {/* Header */}
          <header className="modal-header">
            <span className="modal-category">{article.category}</span>
            <h1 className="modal-title">{article.title}</h1>

            <div className="modal-meta">
              <span className="meta-item">
                โฑ๏ธ {article.read_time} ูุทุงูุนู
              </span>

              {article.author && (
                <span className="meta-item">
                  โ๏ธ {article.author}
                </span>
              )}

              {article.created_at && (
                <span className="meta-item">
                  ๐ {article.created_at}
                </span>
              )}
            </div>
          </header>

          {/* Image */}
          <figure className="modal-image">
            <picture>
              <source media="(max-width: 768px)" srcSet={article.mobile_image} />
              <source media="(min-width: 769px)" srcSet={article.desktop_image} />
              <img src={article.image} alt={article.title} />
            </picture>
          </figure>

          {/* Body */}
          <section className="modal-body">
            <p className="modal-summary">{article.summary}</p>

            <div
              className="modal-full-content"
              dangerouslySetInnerHTML={{ __html: getFullContent() }}
            />
          </section>

          {/* Footer */}
          <footer className="modal-footer">
            <button className="modal-share-btn">
              ๐ค ุงุดุชุฑุงฺฉ ฺฏุฐุงุฑ
            </button>

            <button
              className="modal-print-btn"
              onClick={() => window.print()}
            >
              ๐จ๏ธ ฺุงูพ ููุงูู
            </button>
          </footer>

        </article>
      </div>
    </div>
  );
};

export default ArticleModal;